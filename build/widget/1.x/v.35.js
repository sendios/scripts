/*! v.35 */
!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=11)}([function(e,t,i){"use strict";function n(){var e=document.documentElement,t=document.getElementsByTagName("body")[0],i=window.innerWidth||e.clientWidth||t.clientWidth,n=window.innerHeight||e.clientHeight||t.clientHeight;return{width:i,height:n}}function o(e,t){for(var i=t.split("."),n=0,o=i.length;n<o;n++){var a=i[n];if(!(null!==e&&"object"===("undefined"==typeof e?"undefined":c(e))&&a in e))return!1;e=e[a]}return!0}function a(e,t){var i=n();i.width>=e?$(".mf-wrapper").css({width:e+"px"}):$(".mf-wrapper").css({width:"100%"}),i.height>=t?$(".mf-wrapper").css({height:t+"px"}):$(".mf-wrapper").css({height:"100%"})}function r(e){for(var t="",i=new Uint8Array(e),n=i.byteLength,o=0;o<n;o++)t+=String.fromCharCode(i[o]);return window.btoa(t)}function s(e,t){var i=document.createElement("script");i.src=e,i.type="text/javascript",i.async=!0,i.onload=t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}var u=i(3),d=i(2);t.g=n,t.c=o,t.f=a,t.e=r,t.a=s,i.d(t,"b",function(){return p}),i.d(t,"d",function(){return l});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p={PREFIX:"mf_",get:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+this.PREFIX+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},set:function(e,t,i){i=i||{},"undefined"==typeof i.path&&(i.path="/"),"undefined"==typeof i.domain&&("undefined"!=typeof u.a.subscribe.cookie_domain?i.domain=u.a.subscribe.cookie_domain:i.domain=location.host);var n=i.expires;if("number"==typeof n&&n){var o=new Date;o.setTime(o.getTime()+n),n=i.expires=o.toUTCString()}else if(n&&n.toUTCString)i.expires=n.toUTCString();else{var a=new Date;a.setTime(a.getTime()+31536e6),n=i.expires=a.toUTCString()}t=encodeURIComponent(t);var r=this.PREFIX+e+"="+t;for(var s in i){r+="; "+s;var d=i[s];d!==!0&&(r+="="+d)}document.cookie=r}},l=function(){var e;d.a.debug&&(e=console).log.apply(e,arguments)}},function(e,t,i){"use strict";t.a={}},function(e,t,i){"use strict";t.a={debug:!0,testPopup:!1,showDelay:1e4,registeredNextDelay:6048e5,showedNextDelay:6048e5,showedKey:"popup_showed_v1",resubShowedKey:"popup_resub_showed_v1",showedSecondKey:"popup_showed_second_v1",registeredKey:"user_registered_v1",webpushShowed:"webpush_showed_v1",webpushShowedTTL:1728e5,enteredEmail:"email",enteredEmailTTL:3e5}},function(e,t,i){"use strict";function n(e){if(i.i(a.c)(e,"data.action"))switch(e.data.action){case"close":o.a.popup.remove();break;case"mf-widget-loaded":console.log("mf-widget-loaded"),u.post({email:a.b.get(r.a.enteredEmail)})}i.i(a.c)(e,"data.email")&&(i.i(a.d)("msg.data.email",e.data.email),a.b.set(r.a.enteredEmail,e.data.email,{expires:r.a.enteredEmailTTL}))}var o=i(1),a=i(0),r=i(2);i.d(t,"e",function(){return p}),i.d(t,"d",function(){return l}),i.d(t,"c",function(){return f}),i.d(t,"b",function(){return h});var s={subscribe:{},webpush:{},invalid:null},u=void 0;o.a.settingsLoading=!1,o.a.settingsLoaded=!1,o.a.settingsLoadedCb=function(){return!1};var d=function(){var e=a.b.get("reg_ts");if(!e)return null;var t=Date.now()-1e3*e,i=Math.floor(t/6e4);return i>5},c=function(){var e=a.b.get(r.a.resubShowedKey);return e?+e:null},p=function(){if(s.invalid){var e=c();i.i(a.d)("resubShowed:",e);var t=d();if(i.i(a.d)("resubExpired:",t),e&&e>=2||t)return void i.i(a.d)("üö´ checkInvalid noop. Reason:","showed "+e+" time(s) || exp: "+t);i.i(a.d)("checkInvalid","userId: "+o.a.userId+"; üì™: "+a.b.get(r.a.enteredEmail)),o.a.userId&&$.get("https://api.mailfire.io/v1/user/checkinvalid/"+o.a.userId,function(e){i.i(a.d)("checkInvalid done","unsub =",e.data),e.data&&o.a.Actions.init.showPopup({popupSettings:Object.assign(s.invalid,{invalid:!0})})})}},l=function(e){return e&&setTimeout(p,1e3)},f=function(e){i.i(a.d)("getUserInfo"),a.b.get("guest_id")&&(o.a.guestId=a.b.get("guest_id"),i.i(a.d)("mf_guest_id",o.a.guestId)),$.ajax({url:"https://n.mailfire.io/users/cookie",dataType:"jsonp",success:function(t){var n=t.reg_ts,r=t.user_id,s=t.guest_id;i.i(a.d)("Tried to obtain userId",r),(r||s||n)&&(n&&(a.b.set("reg_ts",n),i.i(a.d)("/users/cookie ->","‚è±",n)),r&&(o.a.userId=r,a.b.set("user_id",r),i.i(a.d)("/users/cookie ->","üë§",r)),s&&(o.a.guestId=s,a.b.set("guest_id",s),i.i(a.d)("/users/cookie ->","üëΩ",s)),e&&e(o.a.userId))}})},h=function(e){return o.a.settingsLoading=!0,i.i(a.d)("settingsLoaded",o.a.settingsLoaded),o.a.settingsLoaded?(console.log("Session.settingsLoaded"),o.a.settingsLoadedCb(!0),void(e&&e())):void $.get("https://api.mailfire.io/v1/widget/settings/"+o.a.project,function(t){Object.keys(t.data).forEach(function(e){return s[e]=t.data[e]}),i.i(a.c)(s,"subscribe.version")?i.i(a.a)("https://scripts.mailfire.io/build/widget/porthole.min.js",function(){u=new Porthole.WindowProxy(s.subscribe.url,"guestFrame"),u.addEventListener(n),o.a.settingsLoading=!1,o.a.settingsLoaded=!0,o.a.settingsLoadedCb(!0),o.a.version=2,e&&e()}):e&&e()})};t.a=s},function(e,t,i){"use strict";var n=i(8),o=i(9),a=i(10),r={1:n.a,2:o.a,3:a.a};t.a=function(e){return r[e.appearence_id||1](e)}},function(e,t,i){"use strict";var n={checkForm:function(e){function t(){o.css({borderColor:"#ff7777",background:"#ffeeee"}).addClass("invalid").focus()}function i(){var e=o.val();return e&&""!==e&&e.indexOf("@")!==-1&&e.indexOf(".")!==-1?($.post("https://api.mailfire.io/v1/email/check",{email:e},function(e){e.data.valid?n.submit():(t(),n.one("submit",i))}),!1):(t(),!1)}var n=$(e),o=n.find(".emailCheck");return!(!o.length&&(o=n.find("input[type:email]"),!o.length))&&(o=$(o[0]),void n.one("submit",i))}};t.a=n},function(e,t,i){"use strict";var n=i(1),o=i(0),a=i(2),r=i(3),s=i(4),u={auto:function(){var e=this;n.a.settingsLoading||(i.i(r.b)(function(){return e.subscribe()}),i.i(r.c)(r.d))},custom:function(){n.a.settingsLoading||(i.i(r.b)(),i.i(r.c)(r.d))},watcher:function(){var e=!0;$(window).on("blur",function(){return e=!1}),$(window).on("focus",function(){return e=!0}),setInterval(function(){if(e){var t=new Image,i=["ts="+(new Date).getTime()];n.a.userId&&i.push("user_id="+n.a.userId),o.b.get("guest_id")&&i.push("guest_id="+o.b.get("guest_id")),t.src="https://n.mailfire.io/online/watch/"+n.a.project+"?"+i.join("&")}},35e3)},subscribe:function(){var e=this;if(!(n.a.userId||void 0!==o.b.get(a.a.registeredKey)||void 0!==o.b.get(a.a.showedKey)&&void 0!==o.b.get(a.a.showedSecondKey))){var t=void 0;void 0!==o.b.get(a.a.showedKey)?(t=1,o.b.set(a.a.showedSecondKey,1,{expires:a.a.showedNextDelay})):t=a.a.showDelay,setTimeout(function(){return e.showPopup({popupSettings:r.a.subscribe})},t)}},removePopup:function(){n.a.popup.remove()},showPopup:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=t.popupSettings,d=t.showCallback,c=t.closeCallback;i.i(o.d)("showPopup");var p=o.b.get("user_id"),l=+o.b.get(a.a.showedKey)||0,f=+o.b.get(a.a.resubShowedKey)||0;if(!a.a.testPopup&&u&&!u.invalid&&(p||l))return void i.i(o.d)("üö´ showPopup noop. Reason:","userId "+p+" || showed "+l);if(u)n.a.popup=i.i(s.a)(u),c&&"function"==typeof c&&(n.a.popup.closeCallback=c),n.a.popup.reloadCallback=function(){i.i(o.d)("reloadCallback"),u.invalid?i.i(r.c)():(setTimeout(function(){return i.i(r.c)(r.e)},5e3),i.i(r.e)()),o.b.set(a.a.registeredKey,Date.now(),{expires:a.a.registeredNextDelay}),n.a.popup.remove()},n.a.popup.show(),i.i(o.d)("üëÅ"),u.invalid||o.b.set(a.a.showedKey,1,{expires:a.a.showedNextDelay}),u.invalid&&o.b.set(a.a.resubShowedKey,f&&f+1||1),d&&"function"==typeof d&&d();else{var e=function(){return n.a.Actions.init.showPopup({popupSettings:r.a.subscribe,showCallback:d,closeCallback:c})};n.a.settingsLoaded?e():i.i(r.b)(),n.a.settingsLoadedCb=e}}};t.a=u},function(e,t,i){"use strict";var n=i(1),o=i(3),a=i(0),r=i(4),s=i(2),u={init:function(){return"serviceWorker"in navigator?void i.i(o.b)():void i.i(a.d)("Service workers aren't supported in this browser.")},auto:function(){if(!("serviceWorker"in navigator))return void i.i(a.d)("Service workers aren't supported in this browser.");var e=a.b.get(s.a.webpushShowed);i.i(a.d)("webpushShowed",e),e||i.i(o.b)(function(){return setTimeout(function(){return n.a.Actions.webpush.showPopup()},2e3)})},showPopup:function(){var e=o.a.webpush,t=e.url,u=e.width,d=e.height;t&&u&&d?(n.a.popup=i.i(r.a)({url:t,width:u,height:d}),a.b.set(s.a.webpushShowed,1,{expires:s.a.webpushShowedTTL}),i.i(a.d)(s.a.webpushShowed,1),n.a.popup.reloadCallback=function(){n.a.Actions.webpush.subscribe(),n.a.popup.remove()},"serviceWorker"in navigator&&n.a.popup.show()):i.i(o.b)(function(){return n.a.Actions.webpush.showPopup()})},trackAttempt:function(e){$.post("https://api.mailfire.io/v1/webpush/attempt/"+n.a.project,{user_id:e&&+e||null},function(){i.i(a.d)("attempt ok")})},subscribe:function(){i.i(a.d)("subscribe"),Notification.requestPermission().then(function(e){i.i(a.d)("result",e),navigator.serviceWorker.ready.then(function(e){i.i(a.d)("serviceWorker.ready"),n.a.userId?n.a.Actions.webpush.trackAttempt(n.a.userId):i.i(o.c)(function(e){return n.a.Actions.webpush.trackAttempt(e)}),e.pushManager.subscribe({userVisibleOnly:!0}).then(function(e){var t={meta:{url:e.endpoint,public_key:i.i(a.e)(e.getKey("p256dh")),auth_token:i.i(a.e)(e.getKey("auth"))}};n.a.userId?t.user_id=+n.a.userId:t.hash=n.a.guestId,$.post("https://api.mailfire.io/v1/webpush/project/"+n.a.project,t,function(e){var t=e.data,n=t.push_user_id;if(n){i.i(a.d)("push_user_id",n),a.b.set("push_user_id",n);var o=new Date;o.setDate(o.getDate()+365),$.ajax({dataType:"jsonp",url:"https://n.mailfire.io/users/setcookie",data:{push_user_id:{value:n,expire:o.toUTCString()}},jsonp:"callback",success:function(e){i.i(a.d)(e)}})}})}).catch(function(e){"denied"===Notification.permission?(i.i(a.d)("Permission for Notifications was denied"),$.post("https://api.mailfire.io/v1/webpush/deny/"+n.a.project,{},function(){i.i(a.d)("deny ok")})):i.i(a.d)("Unable to subscribe to push.",e)})})}).catch(function(){return i.i(a.d)("FAILED")})}};t.a=u},function(e,t,i){"use strict";var n=i(0),o=function(e){var t=e.url,o=e.width,a=e.height,r=$("body"),s=$("<div>").css({width:"100%",height:"100%",top:0,left:0,zIndex:"99999999",opacity:0,position:"fixed",background:"rgba(0,0,0,0.7)",transition:"opacity 1s ease"}),u=i.i(n.g)(),d=$("<div>").css({width:u.width>=o?o+"px":"320px",height:a+"px",top:0,left:0,right:0,bottom:0,margin:"auto",position:"absolute"}).appendTo(s);$("<a>",{href:"javascript:;"}).html("‚úï").css({lineHeight:"20px",height:"20px",font:"12px Arial",position:"absolute",top:"10px",right:"10px",display:"block",textDecoration:"none",color:"#bbb",textAlign:"center"}).appendTo(d).on("click",function(){return p.remove(),!1});var c=$("<iframe>",{src:t}).css({width:"100%",height:"100%",border:0}),p={closeCallback:!1,show:function(){s.appendTo(r),c.appendTo(d).one("load",function(){s.css({opacity:1}),c.one("load",function(){p.reloadCallback()})})},remove:function(){this.closeCallback&&this.closeCallback(),this.closeCallback=!1,s.css({opacity:0}),c.css({opacity:0}),setTimeout(function(){return s.remove()},1e3)}};return p};t.a=o},function(e,t,i){"use strict";var n=i(0),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,o=e.width,a=void 0===o?"100%":o,r=e.height,s=void 0===r?"245px":r,u=document.body,d=document.createElement("style");d.textContent="\n    .mf-bg {\n      width: 100%;\n      height: 100%;\n      top: 0;\n      left: 0;\n      z-index: 99999999;\n      opacity: 0;\n      position: fixed;\n      background: rgba(0,0,0,0.7);\n      transition: opacity 1s ease;\n    }\n    .mf-wrapper {\n      width: "+(+a&&a+"px"||a)+";\n      height: "+(+s&&s+"px"||s)+";\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      margin: auto;\n      position: absolute;\n      min-width: 320px;\n    }\n    .mf-iframe {\n      width: 100%;\n      height: 100%;\n      border: 0;\n    }\n  ";var c=document.createElement("div");c.className="mf-bg";var p=document.createElement("div");p.className="mf-wrapper";var l=document.createElement("iframe");return l.className="mf-iframe",l.src=t,l.scrolling="no",l.name="guestFrame",$(window).resize(function(){return i.i(n.f)(a,s)}),{closeCallback:!1,show:function(){var e=this;u.appendChild(d),u.appendChild(c),c.appendChild(p),p.appendChild(l),l.addEventListener("load",function(){c.style.opacity=1,l.addEventListener("load",function(){e.reloadCallback&&e.reloadCallback()},!1)},!1),i.i(n.f)(a,s)},remove:function(){this.closeCallback&&this.closeCallback(),this.closeCallback=!1,c.style.opacity=0,setTimeout(function(){return u.removeChild(c)},1e3)}}};t.a=o},function(e,t,i){"use strict";var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,i=e.width,n=void 0===i?"100%":i,o=e.height,a=void 0===o?"245px":o,r=document.body,s=window.matchMedia("(max-width: 1400px)"),u=window.matchMedia("(max-width: 990px)"),d=window.matchMedia("(max-width: 735px)"),c=function(){return"all .5s cubic-bezier(0.06, 0.88, 0.26, 1.18)"},p=function(){return d.matches?"all 0.3s":"all 0.4s"},l=function(){return d.matches?"0px":u.matches?"-75px":s.matches?"-120px":"-182px"},f=document.createElement("style");f.textContent="\n    .mf-popup {\n      width: "+(+n&&n+"px"||n)+";\n      height: "+(+a&&a+"px"||a)+";\n      bottom: -250px;\n      left: 0;\n      right: 0;\n      margin: 0 auto;\n      z-index: 99999999;\n      position: fixed;\n    }\n    .mf-iframe {\n      width: 100%;\n      height: 100%;\n      border: 0;\n    }\n  ";var h=document.createElement("div");h.className="mf-popup";var b=document.createElement("iframe");return b.className="mf-iframe",b.src=t,b.scrolling="no",b.name="guestFrame",window.addEventListener("resize",function(){h.style.bottom=l()},!1),{closeCallback:!1,show:function(){var e=this;r.appendChild(f),r.appendChild(h),h.appendChild(b),b.addEventListener("load",function(){h.style.bottom=l(),h.style.transition=c(),b.addEventListener("load",function(){e.reloadCallback&&e.reloadCallback()},!1)},!1)},remove:function(){var e=this;h.style.bottom="-250px",h.style.transition=p(),setTimeout(function(){e.closeCallback&&e.closeCallback(),e.closeCallback=!1,h.parentNode&&r.removeChild(h),f.parentNode&&r.removeChild(f)},500)}}};t.a=n},function(e,t,i){"use strict";function n(e){var t=window[window._mf_object_name];o.a.Actions={init:r.a,webpush:s.a,email:u.a},o.a.project=t.project,o.a.env=t.env||"prod",o.a.popupName=t.popupName,o.a.userId=a.b.get("user_id"),window.mf=function(e,t,i){o.a.Actions[e][t].call(this,i)};for(var i in t.q)if(t.q.hasOwnProperty(i)){var n=t.q[i][0],d=t.q[i][1],c=t.q[i][2];o.a.Actions[n][d](c)}}Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),a=i(0),r=i(6),s=i(7),u=i(5);"undefined"!=typeof window.jQuery?jQuery(function(){return n(jQuery)}):i.i(a.a)("https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js",function(){return Zepto(function(){return n(Zepto)})})}]);
